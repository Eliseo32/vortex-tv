name: ğŸ† Actualizar Agenda Deportiva

on:
  # Corre todos los dÃ­as a las 9:00 AM hora Argentina (UTC-3 â†’ 12:00 UTC)
  schedule:
    - cron: '0 12 * * *'

  # Permite ejecutarlo manualmente desde GitHub â†’ Actions
  workflow_dispatch:

jobs:
  scrape-agenda:
    name: Scraping tvlibree.com â†’ Firestore
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout del repositorio
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Configurar Node.js 20
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          cache-dependency-path: scripts/package.json

      - name: ğŸ“¦ Instalar dependencias del scraper
        working-directory: scripts
        run: npm install

      - name: ğŸš€ Ejecutar scraper de agenda
        working-directory: scripts
        env:
          FIREBASE_SERVICE_ACCOUNT_JSON: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_JSON }}
        run: node scrape-agenda.js

      - name: âœ… Resultado
        if: success()
        run: echo "Agenda actualizada correctamente para $(date +'%d/%m/%Y')"

      - name: âŒ Error
        if: failure()
        run: echo "El scraper fallÃ³. VerificÃ¡ los logs de arriba."
