name: ğŸ† Actualizar Agenda Deportiva

on:
  # Corre cada 2 horas para mantener el estado EN VIVO actualizado
  schedule:
    - cron: '0 */2 * * *'

  # Permite ejecutarlo manualmente desde GitHub â†’ Actions
  workflow_dispatch:

jobs:
  scrape-agenda:
    name: Scraping nowfutbol.xyz â†’ Firestore
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout del repositorio
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Configurar Node.js 20
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          cache-dependency-path: scripts/package.json

      - name: ğŸ“¦ Instalar dependencias del scraper
        working-directory: scripts
        run: npm install

      - name: ğŸš€ Ejecutar scraper de agenda
        working-directory: scripts
        env:
          FIREBASE_SERVICE_ACCOUNT_JSON: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_JSON }}
        run: node scrape-agenda.js

      - name: âœ… Resultado
        if: success()
        run: echo "Agenda actualizada correctamente para $(date +'%d/%m/%Y %H:%M UTC')"

      - name: âŒ Error
        if: failure()
        run: echo "El scraper fallÃ³. VerificÃ¡ los logs de arriba."
